<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<bsh>source(server.props.get("serviceContext").pawHome + "/html/app/bsh/i18n.bsh");</bsh>

<title><bsh>translate("volumes.title");</bsh></title>


	<link rel="stylesheet" href="audio_pleer/pleer.css" />
	<link href="css/font-awesome.css" rel="stylesheet">
	<link href="css/bootstrap.css" rel="stylesheet">

	<script src="js/jquery.min.js"></script>
	<script src="audio_pleer/audioplayer.js"></script>


<script type="text/javascript">

    var music;


	$(document).ready(function() {

        $( 'audio' ).audioPlayer();

        get_data("get_music.xhtml",{ send: "all" }, function(res){
            console.log(res);
            if(res){
                music = res;
                //var Obj = JSON.stringify(res);
                //sessionStorage.setItem('call', Obj);
                gen_table();

            }else{
                return;

            }

            //$('#processing-modal').modal('hide');
        });

        });


    function get_data(html, post_data, callback ){
        var res;
        $.post( html, post_data, function(data) {
            //console.log(data);
            if(data){
                callback(data);
            }else{
                callback(false);
            }
        },"json");
    }




    function gen_table(){
        $("#list").css("height", ($(window).height() * 0.9) + "px");
        $("#list").css("overflow-y", "scroll");

        var tbl = "";

        for (var i=0, count=music.length; i<count; i++) {

            tbl += "<li><a href='javascript:change(\""+music[i].url+"\")' >" + music[i].title + "</a></li><br>";

        }

        $("#result").html(tbl);
    }

	function setVolume(stream) {
		volume = $("#slider_" + stream).slider("value");

		scriptOrg = $("#volumeScript").val();
		script = scriptOrg;
		script = script.replace(/%volume%/, volume);
		script = script.replace(/%stream%/, stream);
		$("#volumeScript").val(script);

		executeScript('volumeScript', "loaderVol_"  + stream);
		$("#volumeScript").val(scriptOrg);

		$("#currentVolume").val(volume);
	}


    function change(url) {
        var audio = $("audio").attr("src", "get_file.xhtml?file="+url)[0];
        $("#name_track").text(check(url));
        audio.play();

    }

    function check(url){
        for (var i=0, count=music.length; i<count; i++) {
            if(music[i].file == url){
                return music[i].title;
            }
        }
    }


</script>
</head>

<body style="overflow-y: scroll; overflow-x: hidden;" >

<div class="navbar  navbar-inverse navbar-fixed-top" >
    <div >
         <div class="navbar-header">
         <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu">
         <span class="sr-only">Открыть</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         </button>
        </div>

           <div class="collapse navbar-collapse " id="menu">
               <ul style="margin-top:15px;margin-left:25px;" class="nav navbar-nav ">
                     <li><span style="color: #0f0;padding: 10px;" id="name_track"></span></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">

                <li><a href="#" ></i></a></li>
                </ul>
           </div>
    </div>
</div>
<div id="wrapper">
       	<audio id="player" controls>
		<source src="res/sound/gong.mp3" />
		</audio>
		</div>

<a href=""></a>
  <div class="container-fluid">
   <div class="row">
    <div id="list" class="col-md-3">
    <ol id="result"></ol>
    </div>

    <div class="col-md-3">
        <h2>Getting started</h2>
        <p>.............</p>
    </div>

 </div>

</div>



</body>
</html>
