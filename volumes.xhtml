<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<bsh>source(server.props.get("serviceContext").pawHome + "/html/app/bsh/i18n.bsh");</bsh>

<title><bsh>translate("volumes.title");</bsh></title>


	<link rel="stylesheet" href="audio_pleer/pleer.css" />
	<link href="css/font-awesome.css" rel="stylesheet">
	<link href="css/bootstrap.css" rel="stylesheet">

	<script src="audio_pleer/jquery.js"></script>
	<script src="audio_pleer/audioplayer.js"></script>


<script type="text/javascript">

    var music;


	$(document).ready(function() {

        $( 'audio' ).audioPlayer();

        get_data("get_music.xhtml",{ send: "all" }, function(res){
            console.log(res);
            if(res){
                music = res;
                //var Obj = JSON.stringify(res);
                //sessionStorage.setItem('call', Obj);
                gen_table();

            }else{
                return;

            }

            //$('#processing-modal').modal('hide');
        });

        });


    function get_data(html, post_data, callback ){
        var res;
        $.post( html, post_data, function(data) {
            //console.log(data);
            if(data){
                callback(data);
            }else{
                callback(false);
            }
        },"json");
    }




    function gen_table(){
        $("#list").css("height", ($(window).height() * 0.9) + "px");
        $("#list").css("overflow-y", "scroll");

        var tbl = "";

        for (var i=0, count=music.length; i<count; i++) {

            tbl += "<li><a href='javascript:change(\""+music[i].url+"\")' >" + music[i].title + "</a></li><br>";

        }

        $("#result").html(tbl);
    }

	function setVolume(stream) {
		volume = $("#slider_" + stream).slider("value");

		scriptOrg = $("#volumeScript").val();
		script = scriptOrg;
		script = script.replace(/%volume%/, volume);
		script = script.replace(/%stream%/, stream);
		$("#volumeScript").val(script);

		executeScript('volumeScript', "loaderVol_"  + stream);
		$("#volumeScript").val(scriptOrg);

		$("#currentVolume").val(volume);
	}


    function change(url) {
        console.log(url);
    var audio = $("audio").attr("src", "get_file.xhtml?file="+url)[0];

    audio.play();


    //$( 'audio' ).audioPlayer();
    /****************/
    //audio.pause();
    //audio.load();//suspends and restores all audio element

    //audio[0].play(); changed based on Sprachprofi's comment below
    //audio.oncanplaythrough = audio.play();
    /****************/
    }




</script>
</head>

<body style="overflow-y: scroll; overflow-x: hidden;" >

<div class="navbar  navbar-inverse navbar-fixed-top" >
    <div >
         <div class="navbar-header">
         <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#menu">
         <span class="sr-only">Открыть</span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         </button>
        </div>

           <div class="collapse navbar-collapse " id="menu">

               <ul class="nav navbar-nav ">

                     <li><a href="#" ><i class="fa fa-fast-backward" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-backward" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-stop" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-play" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-pause" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-forward" aria-hidden="true"></i></a></li>
                     <li><a href="#" ><i class="fa fa-fast-forward" aria-hidden="true"></i></a></li>


                </ul>
                <ul class="nav navbar-nav navbar-right">
                <li><a href="javascript:click('sms.xhtml')" ><i class="fa fa-trash-o " aria-hidden="true"></i></a></li>
                </ul>
           </div>
    </div>
</div>
<div id="wrapper">
       	<audio id="player" controls>
		<source src="#" />
		<source src="audio_pleer/audio.ogg" />
		<source src="audio_pleer/audio.wav" />
		</audio>
		</div>

<a href=""></a>
  <div class="container-fluid">
   <div class="row">
    <div id="list" class="col-md-3">

    <ol   id="result">

    </ol>
    </div>


    <div class="col-md-3">
        <h2>Getting started</h2>
        <p>.............</p>
    </div>

 </div>

</div>



</body>
</html>
